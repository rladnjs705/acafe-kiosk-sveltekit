import{m as P,w as a}from"./singletons-3b1b6c95.js";import{a as f}from"./axios-bff3f665.js";const A=!0,S=A,C=0,y="ADMIN",H="USER",L="add_mode",T="edit_mode";function M(){const{subscribe:e,set:t}=a(!1);return{subscribe:e,set:t,openModal:()=>t(!0),closeModal:()=>t(!1)}}function w(){const e={itemId:"",itemName:"",categoryId:"",itemPrice:0,itemImage:"http://localhost:3000/images/noImage.jpg"},{subscribe:t,set:o}=a({...e});return{subscribe:t,set:o,resetForm:()=>o({...e})}}function E(){const e={pageNumber:0},{subscribe:t,set:o,update:c}=a({...e});return{subscribe:t,nextPage:()=>{c(m=>(m.pageNumber=m.pageNumber+1,p.set(!0),z.set(!0),m))},resetPage:()=>{p.set(!0),o({...e})}}}function v(){const{subscribe:e,set:t}=a("");return{subscribe:e,onAddMode:()=>t(L),onEditMode:()=>t(T)}}function N(){const{subscribe:e,set:t}=a(C);return{subscribe:e,selectCategory:c=>{t(c),j.resetPage(),h.set(!0)}}}function V(){const e="",t=window.localStorage.getItem("token")??e,{subscribe:o,update:c,set:u}=a(t);return{subscribe:o,saveAuthToken:r=>{try{return localStorage.setItem("token",r.token),u(r.token),!0}catch(n){console.log(n)}},removeAuthToken:()=>u(""),checkToken:()=>{const r="";(window.localStorage.getItem("token")??r)||u("")}}}function O(){let e={_id:"",email:"",role:""},t={params:{authToken:""}};const{subscribe:o,set:c}=a({...e});return{subscribe:o,createAuth:async()=>{try{const m="",s=S?window.localStorage.getItem("token")??m:m;t.params.authToken=s;const n=(await f.get("/api/user/login/info",t)).data.data,d=n.id,g=n.email,i=n.role;c({_id:d,email:g,role:i});return}catch{b.removeAuthToken(),c({...e});return}},resetAuth:()=>{b.removeAuthToken(),c({...e})}}}function _(){return P(q,t=>t.role===y)}function D(){const e={userId:0,orderPriceSum:0,orderCount:0,orderItems:[]},{subscribe:t,update:o,set:c}=a({...e});return{subscribe:t,resetOrder:()=>c({...e}),incrementOrder:(s,r)=>{o(n=>{let d=n.orderPriceSum,g=n.orderCount,i=n.orderItems,k=r._id;if(i.find(l=>l.itemId===s.itemId))i=i.map(l=>(l.itemId===s.itemId&&(l.itemPriceSum=l.itemPriceSum+s.itemPrice,l.itemCount=l.itemCount+1),l));else{const l={userId:r._id,itemId:s.itemId,itemName:s.itemName,itemPrice:s.itemPrice,itemPriceSum:s.itemPrice,itemCount:1};i=[...i,l]}return d=d+s.itemPrice,g=g+1,n.orderPriceSum=d,n.orderCount=g,n.orderItems=i,n.userId=k,n})},decrementOrder:s=>{o(r=>{let n=r.orderPriceSum,d=r.orderCount,g=r.orderItems;return g=g.map(i=>(i.itemId===s.itemId&&(i.itemPriceSum=i.itemPriceSum-s.itemPrice,i.itemCount=i.itemCount-1),i)).filter(i=>i.itemCount!==0),console.log(d),n=n-s.itemPrice,d=d-1,r.orderPriceSum=n,r.orderCount=d,r.orderItems=g,r})}}}function F(){const{subscribe:e,update:t,set:o}=a();return{subscribe:e,getCategoryList:async()=>{try{const u=await f.get("/api/user/categories");o(u.data.data)}catch(u){console.log(u)}},update:t}}function R(){let e={page:0,size:10,itemName:"",categoryId:0};const{subscribe:t,update:o,set:c}=a();return{subscribe:t,getItemList:async(I,m,s)=>{try{m!=""&&m!=null?e.itemName=m:e.itemName="",I>0?(p.set(!0),e.page=I):e.page=0,s>0&&s!=null?e.categoryId=s:e.categoryId=0;const r=await f.get("/api/user/items",{params:e});c(r.data.data),h.set(!1)}catch(r){console.log(r)}},update:o}}function x(){const{subscribe:e,update:t,set:o}=a();return{subscribe:e,update:t,set:o,getOrderList:async()=>{try{const u=await f.get("/api/admin/orders/subscribe");o(u.data)}catch(u){console.log(u)}}}}function U(){const{subscribe:e,update:t,set:o}=a();return{update:t,resetErrors:()=>o(),subscribe:e,set:o}}const J=a(!1),K=M(),Q=w(),j=E(),p=a(!1),X=v(),Y=N(),Z=a(""),b=V(),q=O(),$=_(),ee=D(),te=U(),h=a(!1),z=a(!1),oe=F(),re=R(),se=x();export{C as A,T as E,H as U,b as a,Y as b,oe as c,$ as d,re as e,p as f,Z as g,j as h,h as i,q as j,Q as k,ee as l,J as m,X as n,te as o,K as p,L as q,se as r,y as s};
